<div class="game-screen">
  <div class="game-screen-layout">
    <div class="game-view">
      <!-- ko foreach: tiles -->
       <div class="game-tile"
        data-bind="css: { 'wall-top': top === 'TILE_WALL', 'wall-bottom': bottom === 'TILE_WALL', 'wall-right': right === 'TILE_WALL', 'wall-left': left === 'TILE_WALL' }">
        <!-- ko if: containsItems?.length > 0 -->
         <img data-bind="attr: { src: '/assets/' + containsItems[0].iconName.toLowerCase() + '.png' }">
        <!-- /ko -->
        <!-- ko if: occupiedBy?.key -->
         <img data-bind="attr: { src: '/assets/' + occupiedBy.key.toLowerCase() + '.svg' }">
        <!-- /ko -->
      </div>
      <!-- /ko -->
    </div>
    <div class="game-feedback">
      <!-- ko foreach: events -->
      <span data-bind="text: label"></span>
      <!-- /ko -->
    </div>
    <div class="game-minimap">
      <canvas id="minimapCanvas"></canvas>
    </div>
    <div class="game-stats"><strong>Spells on</strong>
      <ul>
        <!-- ko foreach: activeSpells -->
        <li data-bind="text: label + '(' + remaining + ')'"></li>
        <!-- /ko -->
      </ul>
    </div>
    <div class="game-actions">
      <div class="game-hits" data-bind="text: maxHits() + '/' + curHits() + ' HITS left.'"></div>
      <!-- ko foreach: actions -->
      <div class="game-action" data-bind="
          text: label,
          click: $parent.onActionItemClick.bind($parent, key, payload)
        "></div>
      <!-- /ko -->
    </div>
    <div class="game-stats">
      <strong>Characteristics</strong>
      <table>
        <tr>
          <td>Strength</td>
          <td data-bind="text: characterStrength"></td>
        </tr>
        <tr>
          <td>Intelligence</td>
          <td data-bind="text: characterIntelligence"></td>
        </tr>
        <tr>
          <td>Constitution</td>
          <td data-bind="text: characterConstitution"></td>
        </tr>
        <tr>
          <td>Dexterity</td>
          <td data-bind="text: characterDexterity"></td>
        </tr>
      </table>
      <br />
      <strong>Equipment</strong>
      <table>
        <tr>
          <td>Sword</td>
          <td data-bind="text: equipmentSword"></td>
        </tr>
        <tr>
          <td>Shield</td>
          <td data-bind="text: equipmentShield"></td>
        </tr>
        <tr>
          <td>Armor</td>
          <td data-bind="text: equipmentArmor"></td>
        </tr>
        <tr>
          <td>Arrows</td>
          <td data-bind="text: equipmentArrows"></td>
        </tr>
      </table>
    </div>
    <div class="game-stats">
      <strong>Statistics</strong>
      <table>
        <tr>
          <td>Experience</td>
          <td data-bind="text: statisticsExperience"></td>
        </tr>
        <tr>
          <td>Money</td>
          <td data-bind="text: statisticsMoney"></td>
        </tr>
        <tr>
          <td>Next Level</td>
          <td data-bind="text: statisticsNextLevelInXp"></td>
        </tr>
        <tr>
          <td>XP from kills</td>
          <td data-bind="text: statisticsXpPercentageFromKills() + '%'"></td>
        </tr>
        <tr>
          <td>Weight</td>
          <td data-bind="text: statisticsWeight"></td>
        </tr>
        <tr>
          <td>Player level</td>
          <td data-bind="text: statisticsPlayerLevel"></td>
        </tr>
        <tr>
          <td>Spell units</td>
          <td data-bind="text: statisticsSpellUnitsCur() + '/' + statisticsSpellUnitsMax()"></td>
        </tr>
      </table>
    </div>
  </div>
  <div class="game-screen-chat">
    <game-chat params="{
        members: chatMembers,
        messages: chatMessages,
        toPoll: onChatPoll,
        toSendMessage: onSendChatMessage,
        playerName: playerName
    }">
    </game-chat>
  </div>
</div>
<!-- ko if: gameState() === "GAME_END_SUCCESS" && shouldOpenEndDialog() -->
<div class="popup-overlay">
  <div class="popup">
    <div class="popup-title">
      You won!
    </div>
    <div class="popup-message">
      Against all perils of the dungeon, you have emerged victorious! The Orb, long hidden in the depths, is now safely
      in your hands. Legends will speak of your bravery for ages to come!
    </div>
    <div class="popup-actions">
      <button data-bind="click: closeEndDialog">OK</button>
    </div>
  </div>
</div>
<!-- /ko -->
 <!-- ko if: gameState() === "GAME_END_FAIL" && shouldOpenEndDialog() -->
<div class="popup-overlay">
  <div class="popup">
    <div class="popup-title">
      You died!
    </div>
    <div class="popup-message">
      Against the merciless trials of the dungeon, your journey ends here.<br />
      The Orb remains lost in the depths, and your tale fades into silence.<br />
      Not all legends are meant to be told.
    </div>
    <div class="popup-actions">
      <button data-bind="click: closeEndDialog">OK</button>
    </div>
  </div>
</div>
<!-- /ko -->